## Baseline 1 (Face Detection)
The results depicted in Figure 1 are obtained from the direct method utilizing the Haar classifier. As illustrated in the figure, the Haar classifier is not an
optimal method to detect crowds. In crowded scenes, faces are often partially
obscured by other individuals or objects, making full face detection quite challenging. Out of these densely crowded images, it was only able to detect a few
faces and sometimes none entirely. Furthermore, it sometimes mislabeled other
objects as a face. For instance, in image 2 it classified the sign as a face. Interestingly, the classifier correctly label several human’s back inside the bounding
box. This is correct in crowd counting, but only the frontal face detection model
is used. It might be related to the inaccurate situation previously mentioned.
The model inability to detect any faces in image 1 and image 4 can be attributed
to majority of the crowd facing sideways.
Despite these limitations, it does have some advantages. As mentioned, it is
a fast and efficient method, making it a viable choice for real-time applications.
Furthermore, it also has other pre-trained models including eye detection, side
profile detection, etc. It would’ve detected even more people with its versatility
if other models were also used. However, its accuracy in crowd scenes will still
be limited due to its inability to handle occlusions.

Figure 1: Samples’ results obtained from the direct method.

## Baseline 2 (Background Subtraction)
Below are figures demonstrating the method on the PETS09 dataset. The first is the test image, the second is after thresholding log-likelihoods, and the third is after noise removal.

![](/img/S0_Regular_Flow_Time_13-57_View_001_frame_0018.png)
![](/img/threshold_likelihood.png)
![](/img/noise_removal.png)

Current quantitative results: MAE - 4.7, RMSE - 5.77. The
GMM performs reasonably in a surveillance setting. However, the generalization of the method must be questioned. For a dataset like ShanghaiTech, where
there are images of an entire crowd, while it will be good at capturing the crowd
density, it will be much more difficult for this method to accurately capture the
unique number of people. The problem with the connected component analysis
in this case is that closeby objects will all be counted as one person. Going forward, there are still several experiments to improve the results. Three ideas we
have are: to try adding mask on unimportant zones, to search over the threshold value and noise removal parameters, to try cleaning likelihood-map with a
gaussian blur.

Finally, we create a demo video out of the result on PETS09:

![](/img/out_baseline2.mp4)

### Advantages of the GMM method:
• The idea is reasonable and baseline implementation is simple
• Mixture model is flexible, can adapt to multiple scenarios (day, night,
weather, etc) for single scene which is very practical
###Disadvantages of the GMM method:
• Current implementation is very slow, not necessarily faster than NN
• Subject to tuning, so it overfits to specific scenes
• GMM must be trained per scene type, it cannot generalize given data of
a new scene
• Since this method requires a background sample for each scene to train,
it is difficult to compare this method directly with other methods using
other datasets.For example, the ShanghaiTech dataset does not have
background samples. Similarly, the PETS09 dataset does not have labels,
so it is hard to directly compare methods.

## MCNN
We split the training-validation set into 90/10. Because the original paper does not provide specific hyperparameters, we tune this during training to minimize the validation error.
We end up choosing Adam optimizer, training over 2000 iterations through the dataset, with 0.00001 learning rate. See the repository for more details.

On the ShanghaiTechB test dataset, current error metrics are as follows: Mean Absolute
Error (MAE) - 19.18, Root Mean Squared Error (RMSE) - 23.96. It’s important to note
that our complete evaluation method, which is based on a Gaussian density map,
is not directly comparable with our previous methods. We plan to address this
issue in future work. The results of this algorithm are visualized by transforming the original
images to grayscale and overlaying the density map generated by the network.
This provides a clear representation of the crowd density in each image. An example result from the in-distribution test set of ShanghaiTechB is shown below:

![title](/img/output_IMG_5.png)

Additionally, we demonstrate that the generalization of this method works well with the multilayered filter sizes, as even on out of distribution test sets (e.g. PETS09), the result
is very promising and accurate. Our demonstration video is below:

![](/img/out_mcnn.mp4)

# Discussion
## Fine-Grained Crowd Counting

The current network is proficient at identifying the majority of individuals
in the images. However, it does have a few limitations, such as occasionally
misidentifying non-human objects as people. Despite these minor issues, the
overall performance is satisfactory. However, it falls short in discerning whether
individuals are waiting for gym equipment. To address this, we plan to implement the fine-grained, two-branch method in the future.

Segmentation - TODO

Example Result - TODO (add image and explanation)

# Conclusion
TODO

All members contributed equally to the various components of the project.